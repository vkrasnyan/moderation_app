# üö´ NSFW Image Moderation API

## üá∑üá∫ –û–ø–∏—Å–∞–Ω–∏–µ –Ω–∞ —Ä—É—Å—Å–∫–æ–º

–ü—Ä–æ—Å—Ç–æ–µ backend-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–∞ FastAPI, –∫–æ—Ç–æ—Ä–æ–µ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –µ–≥–æ –Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫—É –≤ [Sightengine API](https://sightengine.com/) –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –Ω–µ–∂–µ–ª–∞—Ç–µ–ª—å–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ (NSFW).  

–ï—Å–ª–∏ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –Ω–µ–ø—Ä–∏–µ–º–ª–µ–º–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –ø—Ä–µ–≤—ã—à–∞–µ—Ç 0.7, –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –æ—Ç–∫–ª–æ–Ω—è–µ—Ç—Å—è.

---

## üì¶ –°—Ç–µ–∫

- Python 3.10
- FastAPI
- Sightengine API
- Docker
- pytest

---

## üöÄ –ó–∞–ø—É—Å–∫ –ª–æ–∫–∞–ª—å–Ω–æ

1. –ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:

pip install -r requirements.txt

2. –ó–∞–ø–æ–ª–Ω–∏—Ç–µ .env —Ñ–∞–π–ª –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞:

SIGHTENGINE_USER=your_user_id
SIGHTENGINE_SECRET=your_api_secret

3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä:

uvicorn main:app --reload

–°–µ—Ä–≤–µ—Ä –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ –∞–¥—Ä–µ—Å—É: http://localhost:8000

## üì∏ –ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞ (curl)
curl -X POST http://localhost:8000/moderate \
  -F "file=@example.jpg"
### üì• –û—Ç–≤–µ—Ç—ã:
- –ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ:
{"status": "OK"}
- –û–±–Ω–∞—Ä—É–∂–µ–Ω NSFW-–∫–æ–Ω—Ç–µ–Ω—Ç:
{"status": "REJECTED", "reason": "NSFW content"}

## üì¨ –ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞ –≤ Postman

1. –û—Ç–∫—Ä–æ–π—Ç–µ Postman –∏ —Å–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å
2. –í—ã–±–µ—Ä–∏—Ç–µ –º–µ—Ç–æ–¥: `POST`
3. –í—Å—Ç–∞–≤—å—Ç–µ URL: http://localhost:8000/moderate
4. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤–æ –≤–∫–ª–∞–¥–∫—É **Body** ‚Üí –≤—ã–±–µ—Ä–∏—Ç–µ `form-data`
5. –î–æ–±–∞–≤—å—Ç–µ –ø–æ–ª—è:
   - **Key**: `file`
   - **Type**: `File`
   - **Value**: –≤—ã–±–µ—Ä–∏—Ç–µ `.jpg` –∏–ª–∏ `.png` –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
6. –ù–∞–∂–º–∏—Ç–µ **Send**

### üì• –û—Ç–≤–µ—Ç—ã:
- –ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ:
{
  "status": "OK"
}
- –û–±–Ω–∞—Ä—É–∂–µ–Ω NSFW-–∫–æ–Ω—Ç–µ–Ω—Ç:
{
  "status": "REJECTED",
  "reason": "NSFW content"
}

## üê≥ –ó–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ Docker

### –°–±–æ—Ä–∫–∞ –æ–±—Ä–∞–∑–∞:
docker build -t nsfw-api .
### –ó–∞–ø—É—Å–∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ —Å –ø–µ—Ä–µ–¥–∞—á–µ–π .env:
docker run --env-file .env -p 8000:8000 nsfw-api

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–ü—Ä–æ–µ–∫—Ç –≤–∫–ª—é—á–∞–µ—Ç –±–∞–∑–æ–≤—ã–π —Ç–µ—Å—Ç –Ω–∞ /moderate.

### –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤ –≤ Docker:
docker build -t nsfw-api .
docker run --rm -v $(pwd):/app nsfw-api pytest

### –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤ –ª–æ–∫–∞–ª—å–Ω–æ:
pytest

## üìù –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ

–î–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è Sightengine API –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è –Ω–∞ sightengine.com –∏ –ø–æ–ª—É—á–∏—Ç—å API credentials.

---

## üß© –ò–¥–µ–∏ –¥–ª—è —Ä–∞–∑–≤–∏—Ç–∏—è –ø—Ä–æ–µ–∫—Ç–∞

–≠—Ç–æ –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π MVP, –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É—é—â–∏–π –æ—Ç–ø—Ä–∞–≤–∫—É –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é —Å —Å–µ—Ä–≤–∏—Å–æ–º –º–æ–¥–µ—Ä–∞—Ü–∏–∏ –∫–æ–Ω—Ç–µ–Ω—Ç–∞. –î–ª—è –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –º–æ–∂–Ω–æ –±—ã–ª–æ –±—ã —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å:

### üîê –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏
- –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, —á–µ—Ä–µ–∑ JWT –∏–ª–∏ Telegram)
- –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–∞ –∫ API –ø–æ —Ç–æ–∫–µ–Ω—É

### üóÉÔ∏è –•—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–∏ –ø—Ä–æ–≤–µ—Ä–æ–∫ –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö (PostgreSQL, MySQL –∏ –¥—Ä.)
- –ü—Ä–∏–≤—è–∑–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º
- –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏

### üíæ –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏ —Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ –Ω–∞ –¥–∏—Å–∫ –∏–ª–∏ –≤ S3
- –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞ –∏–ª–∏ —Å–∂–∞—Ç–∏–µ

### üìä –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å
- –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –ø—Ä–æ–≤–µ—Ä–æ–∫
- –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Ä—É—á–Ω–æ–π –º–æ–¥–µ—Ä–∞—Ü–∏–∏
---

–¢–∞–∫–∏–µ —à–∞–≥–∏ –ø–æ–∑–≤–æ–ª—è—Ç –ø—Ä–µ–≤—Ä–∞—Ç–∏—Ç—å –ø—Ä–æ–µ–∫—Ç –≤ –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–π —Å–µ—Ä–≤–∏—Å —Å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–µ–π, –∏—Å—Ç–æ—Ä–∏–µ–π, –∞–Ω–∞–ª–∏—Ç–∏–∫–æ–π –∏ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å—é.


## üá¨üáß English version

A simple backend application built with FastAPI that accepts an uploaded image and sends it to the Sightengine API to detect unwanted (NSFW) content.

If the probability of NSFW content exceeds 0.7, the image is automatically rejected.
---

## üì¶ Tech Stack

- Python 3.10
- FastAPI
- Sightengine API
- Docker
- pytest

---

## üöÄ Running Locally

1. Clone the repository and install dependencies:

pip install -r requirements.txt

2. Create a .env file in the project root and fill in your API credentials:

SIGHTENGINE_USER=your_user_id
SIGHTENGINE_SECRET=your_api_secret

3. Start the development server:

uvicorn main:app --reload
Server will be available at: http://localhost:8000

## üì∏ Example request (curl)
curl -X POST http://localhost:8000/moderate \
  -F "file=@example.jpg"
### üì• Possible responses:
- Safe image:
{"status": "OK"}
- NSFW content detected:
{"status": "REJECTED", "reason": "NSFW content"}

## üì¨ Example request in Postman

1. Open Postman and create a new request
2. Method: POST
3. URL: http://localhost:8000/moderate
4. Go to the Body tab ‚Üí choose form-data
5. Add fields:
   - **Key**: `file`
   - **Type**: `File`
   - **Value**: choose a .jpg or .png image
6. Click **Send**

### üì• –û—Ç–≤–µ—Ç—ã:
- Safe image:
{
  "status": "OK"
}- NSFW content detected:
{
  "status": "REJECTED",
  "reason": "NSFW content"
}

## üê≥ Running via Docker

### Build the image:
docker build -t nsfw-api .
### Run the container with .env:
docker run --env-file .env -p 8000:8000 nsfw-api

## üß™ Testing

The project includes a basic test for the /moderate endpoint.

### Run tests in Docker:
docker build -t nsfw-api .
docker run --rm -v $(pwd):/app nsfw-api pytest

### Run tests locally:
pytest

## üìù Note

To use the Sightengine API, you must sign up at sightengine.com and obtain API credentials.

---

## üß© Ideas for further development

This is a minimal MVP that demonstrates basic integration with an image moderation API. To build a full-fledged service, consider adding:

### üîê Authentication & Users
- User registration and authentication (e.g. via JWT or Telegram login)
- API access control via token

### üóÉÔ∏è Data Storage
- Save moderation history to a database (PostgreSQL, MySQL, etc.)
- Associate images with users
- View moderation statistics

### üíæ Image Handling
- Save uploaded files locally or to S3
- Preprocess: resize, compress, etc.

### üìä Admin Dashboard
- Interface to view moderation results
- Manual moderation option
---
These additions would allow the project to evolve into a scalable image moderation platform with auth, analytics, and persistence.



